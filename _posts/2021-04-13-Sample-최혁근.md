---
layout: post
title:  최혁근 샘플
date:   2021-04-13 00:00:00 +0900
author: 최혁근
tags: computervision objectdetection
excerpt: 동해물과 백두산이 마르고 닳도록 하느님이 무궁화 꽃이 피었습니다.
use_math: false
toc: true
# tags: 자동 수집되는 태그 띄어쓰기로 구분, 반드시 소문자로 사용
# excerpt: 메인 화면에 노출되는 post의 description
# use_math : 수식이 필요 할 경우(윗 첨자, 아랫첨자 동시 사용 불가) true | false
# toc : 목차가 필요 할 경우 true | false
# emoji 사이트: https://getemoji.com/
---

# Object Detection: Survey

디지털 사이니지 프로젝트에는 여러가지 Deep Learning Task들이 존재한다.
그 중 가장 기초가 되는 Object Detection 관련 연구상황을 정리하고 Tensorflow를 이용한 실제 코드 구현을 실습하는 방법을 기록한다.

1. Introduction
2. Problem Definition
3. Performence Measure
4. Dataset & Examples

## 1. Introduction
* Representative tasks in computer vision

![Object detection and other tasks](./figures/task.png)

* Object Detection은 Image Classification task에 사물의 위치를 Bounding Box로 예측하는 Regression task가 추가된 문제이다.

![image classification](https://hoya012.github.io/assets/img/object_detection_first/fig2_classification_example.PNG)
![object detection](https://hoya012.github.io/assets/img/object_detection_first/fig2_classification_example.PNG)
**Object Detection = Multi-labeled classification + Bounding regression**

* 현재 연구 진행상황
![Research history](https://hoya012.github.io/assets/img/object_detection_first/fig4_paper_trend_2019.PNG)
* 적용분야

    ![ADAS](https://hoya012.github.io/assets/img/object_detection_third/fig1.PNG)
    ![CCTV](https://hoya012.github.io/assets/img/object_detection_third/fig2.PNG)
    ![OCR](https://hoya012.github.io/assets/img/object_detection_third/fig3.PNG)
    ![Aerial Image](https://hoya012.github.io/assets/img/object_detection_third/fig4.PNG)
    ![Body Detection](https://hoya012.github.io/assets/img/object_detection_third/fig5.PNG)
    ![Sport Analysis](https://hoya012.github.io/assets/img/object_detection_third/fig7.PNG)
    ![Amazon Go](https://hoya012.github.io/assets/img/object_detection_third/fig8.PNG)

## 2. Problem Definition
* DATASET
    - $I$ - an image
    - $O(I)$ - objects with descriptions in the image $I$ 
        - $O(I) = \{ (Y_1^*, Z_1^*), \ldots, (Y_i^*, Z_i^*), \ldots, (Y_{N_i^*}^*, Z_{N_i^*}^*)\}$
        - $Y_i^* \in \mathcal{Y}$ - the category of the $i$th object
        - $Z_{N_i^*}^* \in \mathcal{Z}$ - the bounding box information of $i$th object, ex. $(x, y, w, h)$
* Object Detection $D(I, \lambda)$
    - 이미지 $I$에 Objects $O(I)$를 찾아내는 함수 $D$를 구하기
    - $D(I, \lambda) = \{ (Y_1, Z_1), \ldots, (Y_i, Z_i),\ldots, (Y_{N_i(\lambda)}, Z_{N_i(\lambda)})\}$
    - $\lambda$로 false alarm과 missed detection 조절

## 3. Performance Measure
* Ground Truth $O(I)$와 Prediction $D(I, \lambda)$를 비교
    - classification : 각각의 class를 정확하게 예측했는가? 
    - regression : 정확하게 Bounding Box의 위치와 크기를 지정했는가?
        + Intersection Over Union(IoU)
            * ![IOU](https://hoya012.github.io/assets/img/object_detection_fourth/fig1.PNG)
            * ![IOU Example](https://hoya012.github.io/assets/img/object_detection_fourth/fig2.PNG)
            * IoU값이 일정이상일 경우 정답으로 간주
                * PASCAL VOC : 0.5
                * ImageNet : min(0.5, wh / (w+10)(h+10))
                * MS COCO : 0.5, 0.55, $\ldots$, 0.95
* Mean Average Precision(mAP)
    - Average Precision
        + ![AP](https://img1.daumcdn.net/thumb/R720x0.q80/?scode=mtistory2&fname=http%3A%2F%2Fcfile2.uf.tistory.com%2Fimage%2F220E10365869F5CA344843)
        + Recall을 0부터 1까지 0.1단위로 증가시키면서 얻은 precision값을 평균내어 계산
    - mAP
        + 전체 Class에 대해서 AP를 계산하여 평균낸 값
* Frame Per Second
    - 초당 처리가능한 이미지의 수 (이미지 종류와 하드웨어에 따라 상대적인 값)
    - 최근 논문은 정확도 뿐만 아니라 속도에도 집중하는 경향
  
## 4. miscellanea
### Techniques before deep learning
* Sliding Windows
![sw1](https://hoya012.github.io/assets/img/object_detection_first/fig6_sliding_window.PNG)
* Selective Search
![ss](https://hoya012.github.io/assets/img/object_detection_first/fig7_selective_search.PNG)

### Stages
*  1-stage object detector
![1-stage object detector](https://hoya012.github.io/assets/img/object_detection_second/fig6_1stage.PNG)
*  2-stage object detector
![2-stage object detector](https://hoya012.github.io/assets/img/object_detection_second/fig5_2stage.PNG)

### Dataset
* [PASCAL VOC](http://host.robots.ox.ac.uk/pascal/VOC/)
    - Pattern Analysis, Statistical Modeling and Computational Learning
    - 20 Object types
        + 사람: 사람
        + 동물: 새, 고양이, 소, 개, 말, 양
        + 탈것: 비행기, 자전거, 보트, 버스, 승용차, 오토바이, 기차
        + 사물: 병, 의자, 식탁, 화초, 소파, 모니터
    - 대표적으로 VOC05, VOC12 가 많이 사용됨

![vocex1](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/examples/images/car_01_thumb.jpg)
![vocex2](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/examples/images/car_02_thumb.jpg)
![vocex3](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/examples/images/car_03_thumb.jpg)
![vocex4](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/examples/images/car_04_thumb.jpg)

![vocex5](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/examples/images/bird_01_thumb.jpg)
![vocex6](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/examples/images/bird_02_thumb.jpg)
![vocex7](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/examples/images/bird_03_thumb.jpg)
![vocex8](http://host.robots.ox.ac.uk/pascal/VOC/voc2012/examples/images/bird_04_thumb.jpg)

* [MS COCO](https://cocodataset.org/#home)
    - 91 Object types, 328k images, 2.5m labeled instance
    
![cocoex](https://www.researchgate.net/profile/Minkesh_Asati/publication/334867305/figure/fig1/AS:787322064875522@1564723616547/Samples-of-annotated-images-in-the-MS-COCO-dataset-from-12.jpg)


## Reference
* [Object Detection Survey by walton-wang929](https://github.com/walton-wang929/Object_Detection)
* [Recent Advances in Object Detection in the Age of Deep Convolutional Neural Networks](https://arxiv.org/abs/1809.03193)
* [HOYA012's Research Blog - Tutorial of Object Detection using Deep Learning](https://hoya012.github.io/blog/Tutorials-of-Object-Detection-Using-Deep-Learning-what-is-object-detection/)