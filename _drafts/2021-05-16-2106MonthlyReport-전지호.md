---
layout: post
title:  6월 머신러닝파트 월간 리뷰
date:   2021-06-02 00:00:00 +0900
author: 전지호
tags: monthlyreport
excerpt: 과금넛지와 디지털사이니지, 오프라인 광고지역 선정에 대한 리뷰입니다.
use_math: false
toc: true
# tags: 자동 수집되는 태그 띄어쓰기로 구분, 반드시 소문자로 사용
# excerpt: 메인 화면에 노출되는 post의 description
# use_math : 수식이 필요 할 경우(윗 첨자, 아랫첨자 동시 사용 불가) true | false
# toc : 목차가 필요 할 경우 true | false
# emoji 사이트: https://getemoji.com/
---

# 6월 리뷰 📆

<br/>

> For McKinsey

<br/>

## 과금넛지

<br/>

> 넛지반응 모델링을 위해 과금예측모델링을과 캐시플로우 정제 작업 중 주요 이슈에 봉착했습니다.

<br/>
<hr/>
<br/>

## 디지털사이니지

<br/>

> 디지털사이니지 마일스톤 중 FGT 웹 솔루션 제작 단계에 돌입했습니다. 또한, 아이덴티피케이션 모델 개발에 착수 했습니다.

<br/>
<hr/>
<br/>

## 머신러닝 파이프라인

<br/>

> 머신러닝파트는 1년 간 머신러닝 서비스 운영 기술적 노하우를 축적하려 노력했습니다. 공유할 수 있는 결과물이 나오기 시작했습니다.

<br/>

### 첫 번째, 머신러닝파트의 BI를 도입했습니다. 쿠버네티스 기반의 JupyterHub를 구축했습니다.

<br/>

현재, 랩스내 많은 분석 조직에서 EC2 기반 EMR 제플린을 사용하고 있습니다.

컨텐츠 서비스 개발팀, ADS 개발팀이 그러합니다.

EC2에 하둡(아파티 스파크 사용을 위한)얼 설치한 EMR 제플린은 많은 사용자가 동시 사용 시, <u>한 작업이 리소스가 많이 필요할 경우</u> 다른 사용자의 다른 작업에 영향을 줍니다. 

최악의 경우, 제플린 서버의 프로세스가 멈추어, EC2 재시작하는 경우가 허다합니다.

때문에, 작업자마다 완전히 분리된 독립적인 분석 환경과 테스트 환경을 제공해줘야 합니다.

머신러닝 파트는 쿠버네티스 기반의 JupyterHub를 구축하여 가능하게 했습니다.

👉 [<u>머신러닝파트 주피터허브</u>](http://mlhub.na.nexon.co.kr)

<br/>

아시다시피, 도커 컨테이너는 독립적인 환경을 보장합니다.

쿠버네티스 기반의 주피터허브는 사용자가 로그인 시, 그때마다 도커 컨테이너를 만듭니다. 한 작업 컨테이너가 <b>폭파-!</b> 되도 다른 컨테이너에 영향을 주지 않습니다.

심지어 각 컨테이너마다 분석에 쓰이고자 하는 라이브러리 사양을 골라서 만들수 있고,

해당 컨테이너도 커스터 마이징이 가능합니다.

머신러닝파트는 랩스내 nxlog에 접근할 수 있는 하둡 기반의 pyspark 컨테이너, 머신러닝 프레임워크가 설치된 pytorch, tensorflow가 각각 설치된 3개의 컨테이너를 내부 사양에 맞게 커스터마이징하여 사용하고 있습니다.

10분 간, 사용하지 않는 컨테이너는 자동으로 내려갑니다. 따라서 쿠버네티스내 리소스는 효율적으로 관리됩니다.

전 세계에서 가장 유명한 머신러닝 혹은 데이터분석 도구인 kubeflow, sagemaker, 데이터브릭스에서 제공하는 기능입니다. 해당 기능을 각 조직마다 구축해 내부적으로 사용할 수 있습니다.

<br/>

### 두 번째, 머신러닝파트 JupyterHub안에 있는 코드는 자연스럽게 서비스 레벨로 배포할 수 있습니다.

<br/>

아시다시피, 일반 웹서비스처럼 머신러닝 혹은 분석 서비스 또한 라이브 레벨에서는 많은 유지 보수의 비용이 들어갑니다.

현재의 경우처럼 Job을 만들어 airflow로 실행하는 형태의 업무는 실제 대규모 서비스 레벨에 올라갈 경우, 많은 문제를 야기할 수 있습니다.

일단 <u><b>형상관리</b></u>가 되지 않습니다. 

실수로 서비스 단계에 잘못된 소스가 올라갈 경우, 롤백에 취약하며, 작업자의 실수로 이전 코드를 찾을 수 없는 문제가 발생할 수 있습니다.

공동 작업의 경우, 코드를 수정한 사람이나, 배포를 한 사람을 찾아내기 힘들 수도 있습니다.

서든어택 월핵탐지기 경우처럼 다른 조직과 협업하여 하루에 수십만 건 이미지를 머신러닝 코드로 처리하는 프로세스와 같은 서비스가 있다면, 이러한 취약점은 감당하기 힘든 문제로 돌아올 수 도 있습니다. 인텔리전스랩스의 분석 및 머신러닝 서비스가 네이버페이, 카카오페이같은 일반 사용자 대상 금융 서비스라고 가정하면 대부분의 분석 서비스가 큰 어려움을 겪을 것이라고 쉽게 생각할 수 있습니다.

현재 월핵탐지와 FGT 감정추론의 경우 <u><b>개발자의 도움</b></u>없이 작업자가 머신러닝 코드만 수정하여 배포, 롤백, 형상관리, 모니터링이 모두 가능합니다.

머신러닝 파이프라인에 MLOps라 불리는 CI/CD를 적용했습니다.

👉 [<u>월핵탐지기 모니터링 ArgoCD</u>](https://a4b2cf330e1d2464a951ba793aaae70e-596153973.ap-northeast-2.elb.amazonaws.com/)

👉 [<u>FGT 실시간 감정추론 모니터링 ArgoCD</u>](https://ad1f03f16a72740d68c582a87b928f1b-1924335043.ap-northeast-2.elb.amazonaws.com/)

<br/>

### 세 번째, MLOps


<br/>
<hr/>
<br/>

## 옥외광고 지역 선정

> 넥슨유저의 위치정보 기반의 지역을 선정하다가 데이터의 한계를 느끼고 새로운 아이데이션에 착수했습니다.

<br/>
<hr/>
<br/>

## 상시 업무

> 티나지 않지만, 넥슨에 도움이 되는 업무를 지속적으로 하고 있습니다.

마무리한다